#!/usr/bin/make -f

DPKG_EXPORT_BUILDFLAGS = 1

DEB_LDFLAGS_MAINT_APPEND = -Wl,--no-as-needed

DEB_BUILD_MAINT_OPTIONS = hardening=+all

include /usr/share/dpkg/default.mk

export AUTOPOINT=intltoolize --automake --copy

%:
	dh $@


build:
	dpkg-source -x $(CURDIR)/debian/pulseaudio_12.2-4+deb10u1.dsc
	dh build

clean:
	dh clean

override_dh_testdir:
	(cd pulseaudio-12.2; dh_testdir)
	dh_testdir

override_dh_update_autotools_config:
	(cd pulseaudio-12.2; dh_update_autotools_config)
	dh_update_autotools_config

override_dh_autoreconf:
	(cd pulseaudio-12.2; dh_autoreconf)
	dh_autoreconf

override_dh_auto_configure:
	(cd pulseaudio-12.2; debian/rules override_dh_auto_configure)
	dh_auto_configure -- PULSE_DIR=$(CURDIR)/pulseaudio-12.2

override_dh_auto_install:
	dh_auto_install
	-rm $(CURDIR)/debian/pulseaudio-module-xrdp/usr/lib/pulse-*/modules/*.la

override_dh_missing:
	dh_missing --fail-missing

override_dh_clean:
	#-(cd pulseaudio-12.2; dh clean)
	rm -rf pulseaudio-12.2
	rm -f pulseaudio_12.2.orig.tar.xz
	dh_clean
	rm -f debian/shlibs.local
